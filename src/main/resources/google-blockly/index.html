<!DOCTYPE html>
<html lang="sk">
	<!-- ++++++++++++++++++++ WEBPAGE LAYOUT & STYLE ++++++++++++++++++++ -->
	<head>
		<meta charset="utf-8">
		<title></title>
		<style>
			html, body, #blocklyArea {
				height: 100%;
				margin: 0;
			}
		</style>		
	</head>
	
	<body>  
		<div id="blocklyDiv" style="position: absolute"></div>
		<div id="blocklyArea"></div>  
		
		<!-- ++++++++++++++++++++ BLOCKLY LIBRARY ++++++++++++++++++++ -->
		<script src="blockly_uncompressed.js"></script>
		<script src="en.js"></script>
		
		<!-- ++++++++++++++++++++ CUSTOM BLOCKLY BLOCKS & GENERATORS ++++++++++++++++++++ -->

		<script src="generators/otto-basic.js"></script>
		
		<script src="generators/otto-procedural/otto-procedural.js"></script>
		<script src="generators/otto-procedural/lists.js"></script>
		<script src="generators/otto-procedural/logic.js"></script>
		<script src="generators/otto-procedural/loops.js"></script>
		<script src="generators/otto-procedural/math.js"></script>
		<script src="generators/otto-procedural/procedures.js"></script>
		<script src="generators/otto-procedural/text.js"></script>
		<script src="generators/otto-procedural/variables.js"></script>
		<script src="generators/otto-procedural/variables_dynamic.js"></script>
		<script src="generators/otto-procedural/otto.js"></script>
		<script src="generators/otto-procedural/sound.js"></script>
		<script src="generators/otto-procedural/motion.js"></script>
		<script src="generators/otto-procedural/ultrasound.js"></script>
		<script src="generators/otto-procedural/serial.js"></script>
		
		<script src="blocks/otto-basic.js"></script>
		<script src="blocks/lists.js"></script>
		<script src="blocks/logic.js"></script>
		<script src="blocks/loops.js"></script>
		<script src="blocks/math.js"></script>
		<script src="blocks/procedures.js"></script>
		<script src="blocks/text.js"></script>
		<script src="blocks/variables.js"></script>
		<script src="blocks/variables_dynamic.js"></script>
		<script src="blocks/sound.js"></script>
		<script src="blocks/motion.js"></script>
		<script src="blocks/ultrasound.js"></script>
		<script src="blocks/serial.js"></script>
		
		<xml id='toolbox-otto-procedural' style='display: none'>
			<category name='Logic' categorystyle='logic_category' toolboxitemid='logic'>
				<block type='controls_if'></block>
				<block type='logic_compare'></block>
				<block type='logic_operation'></block>
				<block type='logic_negate'></block>
				<block type='logic_boolean'></block>
				<block type='logic_ternary'></block>
			</category>
							
			<category name='Loops' categorystyle='loop_category' toolboxitemid='loops'>
				<block type='controls_repeat_ext'>
					<value name='TIMES'>
						<shadow type='math_number'>
							<field name='NUM'>10</field>
						</shadow>
					</value>
				</block>
				<block type='controls_whileUntil'></block>
				<block type='controls_for'>
					<value name='FROM'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>
					<value name='TO'>
						<shadow type='math_number'>
							<field name='NUM'>10</field>
						</shadow>
					</value>
					<value name='BY'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>
				</block>
				<block type='controls_flow_statements'></block>	
			</category>
							
			<category name='Math' categorystyle='math_category' toolboxitemid='math'>
				<block type='math_number' gap='32'>
					<field name='NUM'>123</field>
				</block>
				<block type='math_arithmetic'>
					<value name='A'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>
					<value name='B'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>
				</block>
				<block type='math_single'>
					<value name='NUM'>
						<shadow type='math_number'>
							<field name='NUM'>9</field>
						</shadow>
					</value>
				</block>
				<block type='math_number_property'>
					<value name='NUMBER_TO_CHECK'>
						<shadow type='math_number'>
							<field name='NUM'>0</field>
						</shadow>
					</value>
				</block>
				<block type='math_modulo'>
					<value name='DIVIDEND'>
						<shadow type='math_number'>
							<field name='NUM'>64</field>
						</shadow>
					</value>
					<value name='DIVISOR'>
						<shadow type='math_number'>
							<field name='NUM'>10</field>
						</shadow>
					</value>
				</block>
				<block type='math_random_int'>
					<value name='FROM'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>
					<value name='TO'>
						<shadow type='math_number'>
							<field name='NUM'>100</field>
						</shadow>
					</value>
				</block>
			</category>
							
			<sep></sep>
			
			<category name='Variables' categorystyle='variable_category' custom='VARIABLE_DYNAMIC' toolboxitemid='variables'></category>
			
			<category name='Functions' categorystyle='procedure_category' custom='PROCEDURE' toolboxitemid='functions'></category>
			
			<sep></sep>
			
			<category name='Sound' colour='30' toolboxitemid='sound'>
				<label text='Mp3 player'></label>
				<block type='mp3_play_song'>
					<value name='SONG_NO'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>				
				</block>
				<block type='mp3_set_volume'>
					<value name='VOLUME_LEVEL'>
						<shadow type='math_number'>
							<field name='NUM'>15</field>
						</shadow>
					</value>
				</block>
				
				<label text='Melodies'></label>
				<block type='melody_play'>
					<value name='MELODY_NO'>
						<shadow type='math_number'>
							<field name='NUM'>1</field>
						</shadow>
					</value>
				</block>
				<block type='melody_stop'></block>
				
				<label text='Other'></label>
				<block type='beep'></block>
				<block type='play_sound_effect'>
					<value name='EFFECT_NO'>
						<shadow type='math_number'>
							<field name='NUM'>3</field>
						</shadow>
					</value>
				</block>
				<block type='tone_play'>
					<value name='FREQUENCY'>
						<shadow type='math_number'>
							<field name='NUM'>2000</field>
						</shadow>
					</value>
					<value name='DURATION'>
						<shadow type='math_number'>
							<field name='NUM'>30</field>
						</shadow>
					</value>
				</block>
			</category>
			
			<category name='Motion' colour='60' toolboxitemid='motion'>
				<block type='otto_procedural_motor_move'>
					<value name='MOTOR_POSITION'>
						<shadow type='math_number'>
							<field name='NUM'>30</field>
						</shadow>
					</value>
				</block>
				<block type='reset_motors'></block>
			</category>
			
			<category name='Ultrasound' colour='90' toolboxitemid='ultrasound'>
				<block type='otto_procedural_ultrasound_get_distance'></block>
			</category>
			
			<category name='Serial' colour='180' toolboxitemid='serial'>
				<label text='Send'></label>
				<block type='serial_println'>
					<value name='MESSAGE'>
						<shadow type='text'>
							<field name='TEXT'>Hello</field>
						</shadow>
					</value>
				</block>
				<label text='Receive'></label>
				<block type='serial_get_string'></block>
				<block type='serial_get_number'></block>
				<label text='String'></label>
				<block type='text'>
					<field name='TEXT'>Message</field>
				</block>
			</category>
		</xml>

		
		
		<!-- ++++++++++++++++++++ SETUP & INJECT BLOCKLY ++++++++++++++++++++ '<xml id="toolbox"><category></category></xml>', -->			
		<script>
			var options = { 
				toolbox : document.getElementById('toolbox-otto-procedural'), 
				collapse : false, 
				comments : false, 
				disable : true, 
				maxBlocks : Infinity, 
				trashcan : false, 
				horizontalLayout : false, 
				toolboxPosition : 'start', 
				css : true,  
				rtl : false, 
				scrollbars : true, 
				sounds : true, 
				oneBasedIndex : true,
				zoom:
					{controls: true,
					wheel: true,
					startScale: 1.0,
					maxScale: 3,
					minScale: 0.3,
					scaleSpeed: 1.2,
					pinch: true}
			};
		
			var blocklyArea = document.getElementById('blocklyArea');
			var blocklyDiv = document.getElementById('blocklyDiv');
			var workspace = Blockly.inject(blocklyDiv, options);
			var onresize = function(e) {
				var element = blocklyArea;
				var x = 0;
				var y = 0;
				do {
					x += element.offsetLeft;
					y += element.offsetTop;
					element = element.offsetParent;
				} while (element);
				blocklyDiv.style.left = x + 'px';
				blocklyDiv.style.top = y + 'px';
				blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
				blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
				Blockly.svgResize(workspace);
			};
			window.addEventListener('resize', onresize, false);
			onresize();
			Blockly.svgResize(workspace);
			
			function myUpdateFunction(event) {
				//var code = Blockly.JavaScript.workspaceToCode(workspace);
				window.javaCall.workspaceChanged();
			}
			//workspace.addChangeListener(myUpdateFunction);
			workspace.addChangeListener(Blockly.Events.disableOrphans);			
			
		</script>
	</body>
</html>